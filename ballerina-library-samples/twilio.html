<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <!-- Google tag (gtag.js) -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-R8JELXRZ0T"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-R8JELXRZ0T');
        </script>
        <meta charset="UTF-8">
        <title>Twilio - Ballerina Programming Language Best Practices Guide</title>
                        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />
        <meta name="google-site-verification" content="9u9TWuccKXyP6XsNDgrG1xdb4GGWVDzuqURpV2FWGUs" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../index.html">Home</a></li><li class="chapter-item "><a href="../best_practices/project_best_practices.html"><strong aria-hidden="true">1.</strong> Project best practices</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../best_practices/structure_your_code.html"><strong aria-hidden="true">1.1.</strong> Structure your code</a></li><li class="chapter-item "><a href="../best_practices/naming_conventions.html"><strong aria-hidden="true">1.2.</strong> Naming conventions</a></li><li class="chapter-item "><a href="../best_practices/format_the_code.html"><strong aria-hidden="true">1.3.</strong> Format the code</a></li><li class="chapter-item "><a href="../best_practices/logging.html"><strong aria-hidden="true">1.4.</strong> Logging</a></li><li class="chapter-item "><a href="../best_practices/documenting_the_source_code.html"><strong aria-hidden="true">1.5.</strong> Documenting the source code</a></li><li class="chapter-item "><a href="../best_practices/configuration_management.html"><strong aria-hidden="true">1.6.</strong> Configuration management</a></li><li class="chapter-item "><a href="../best_practices/dependency_management.html"><strong aria-hidden="true">1.7.</strong> Dependency management</a></li></ol></li><li class="chapter-item "><a href="../best_practices/language_best_practices.html"><strong aria-hidden="true">2.</strong> Language best practices</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../best_practices/represent_optionality.html"><strong aria-hidden="true">2.1.</strong> Represent optionality</a></li><li class="chapter-item "><a href="../best_practices/handle_nil_values.html"><strong aria-hidden="true">2.2.</strong> Handle nil values</a></li><li class="chapter-item "><a href="../best_practices/use_precise_types.html"><strong aria-hidden="true">2.3.</strong> Use precise types</a></li><li class="chapter-item "><a href="../best_practices/value_ranges.html"><strong aria-hidden="true">2.4.</strong> Work with value ranges</a></li><li class="chapter-item "><a href="../best_practices/avoid_unnecessary_type_casts.html"><strong aria-hidden="true">2.5.</strong> Avoid unnecessary type casts</a></li><li class="chapter-item "><a href="../best_practices/included_record_params.html"><strong aria-hidden="true">2.6.</strong> Using included record parameters</a></li><li class="chapter-item "><a href="../best_practices/expression_bodied_func.html"><strong aria-hidden="true">2.7.</strong> Use expression-bodied functions</a></li><li class="chapter-item "><a href="../best_practices/use_tuple_to_return_multiple_values.html"><strong aria-hidden="true">2.8.</strong> Use tuples to return multiple values</a></li><li class="chapter-item "><a href="../best_practices/return_errors_and_use_check.html"><strong aria-hidden="true">2.9.</strong> Return errors and use the check</a></li><li class="chapter-item "><a href="../best_practices/avoid_unnecessary_panic.html"><strong aria-hidden="true">2.10.</strong> Avoid unnecessary usage of panic</a></li><li class="chapter-item "><a href="../best_practices/use_open_vs_closed_records.html"><strong aria-hidden="true">2.11.</strong> Use open vs closed records</a></li><li class="chapter-item "><a href="../best_practices/mapping_constructors.html"><strong aria-hidden="true">2.12.</strong> Simplify mapping constructor</a></li><li class="chapter-item "><a href="../best_practices/avoid_unnecessary_objects.html"><strong aria-hidden="true">2.13.</strong> Avoid unnecessary objects</a></li><li class="chapter-item "><a href="../best_practices/constants.html"><strong aria-hidden="true">2.14.</strong> Using constants</a></li><li class="chapter-item "><a href="../best_practices/string_unions.html"><strong aria-hidden="true">2.15.</strong> Handle unions of string constants</a></li><li class="chapter-item "><a href="../best_practices/int_unions.html"><strong aria-hidden="true">2.16.</strong> Handle unions of integer constants</a></li><li class="chapter-item "><a href="../best_practices/string_concat.html"><strong aria-hidden="true">2.17.</strong> Generate string by concatenating values</a></li><li class="chapter-item "><a href="../best_practices/avoid_parentheses.html"><strong aria-hidden="true">2.18.</strong> Avoid parentheses in if statement</a></li><li class="chapter-item "><a href="../best_practices/using_match_statement.html"><strong aria-hidden="true">2.19.</strong> Using match statement</a></li><li class="chapter-item "><a href="../best_practices/using_query_expressions_for_iterations.html"><strong aria-hidden="true">2.20.</strong> Using query expressions for iterations</a></li></ol></li><li class="chapter-item "><a href="../best_practices/common_best_practices.html"><strong aria-hidden="true">3.</strong> Common best practices guide</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../best_practices/early_returns.html"><strong aria-hidden="true">3.1.</strong> Use early returns</a></li><li class="chapter-item "><a href="../best_practices/avoid_redundant_variables.html"><strong aria-hidden="true">3.2.</strong> Avoid redundant variables</a></li><li class="chapter-item "><a href="../best_practices/avoid_unnecessary_comments.html"><strong aria-hidden="true">3.3.</strong> Avoid unnecessary comments</a></li><li class="chapter-item "><a href="../best_practices/wrap_code.html"><strong aria-hidden="true">3.4.</strong> Wrap code at 120 characters</a></li><li class="chapter-item "><a href="../best_practices/use_proper_titles.html"><strong aria-hidden="true">3.5.</strong> Use proper commit messages and PR titles</a></li></ol></li><li class="chapter-item "><a href="../resources/index.html"><strong aria-hidden="true">4.</strong> Learning resources</a></li><li class="chapter-item "><a href="../faq.html"><strong aria-hidden="true">5.</strong> Ballerina FAQ</a></li><li class="chapter-item expanded "><a href="../ballerina-library-samples/ballerina-library-samples.html"><strong aria-hidden="true">6.</strong> Ballerina library samples</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ballerina-library-samples/twilio.html" class="active"><strong aria-hidden="true">6.1.</strong> Twilio</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Ballerina Programming Language Best Practices Guide</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/learn-ballerina/learn-ballerina.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="twilio-connector---ballerina"><a class="header" href="#twilio-connector---ballerina">Twilio Connector - Ballerina</a></h1>
<p>In today’s interconnected world, communication is key, and what better way to enhance your application’s communication capabilities than by integrating <a href="https://www.twilio.com/en-us">Twilio</a> with the <a href="https://ballerina.io/">Ballerina</a> programming language? </p>
<p>Ballerina, known for its simplicity and power in building cloud-native integrations, combines with Twilio’s versatile <a href="https://dzone.com/articles/3-types-of-user-communication-apis-and-when-to-use">communication APIs</a> to help you send SMS, make voice calls, send WhatsApp messages, and more. </p>
<p>In this guide, we’ll explore how the <code>ballerinax/twilio</code> package can empower you to build robust communication features effortlessly. Refer to <a href="https://lib.ballerina.io/ballerinax/twilio/latest">ballerina/twilio API Docs</a> for more details.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ul>
<li>Install <a href="https://ballerina.io/downloads/">Ballerina Swan Lake</a> and <a href="https://wso2.com/ballerina/vscode/">Ballerina VS Code plugin</a>.</li>
<li>Create a <a href="https://www.twilio.com/en-us">Twilio</a> account.</li>
<li>Obtain <a href="https://support.twilio.com/hc/en-us/articles/223136107-How-does-Twilio-s-Free-Trial-work-">Twilio phone number</a>.</li>
<li>Obtain <a href="https://support.twilio.com/hc/en-us/articles/223136027-Auth-Tokens-and-How-to-Change-Them">Twilio Auth Tokens</a>.</li>
<li>Obtain the Twilio WhatsApp number from the <a href="https://www.twilio.com/console/sms/whatsapp/sandbox">Console’s WhatsApp Sandbox</a>.</li>
</ul>
<h2 id="sample-1-sendreceive-calls-and-messages-with-ballerina"><a class="header" href="#sample-1-sendreceive-calls-and-messages-with-ballerina">Sample 1: Send/Receive Calls and Messages With Ballerina</a></h2>
<p>Create a new Ballerina package using the command below.</p>
<pre><code>bal new send-receive-with-twilio
</code></pre>
<p>This creates a new Ballerina package in the default module with the <code>Ballerina.toml</code> file, which identifies a directory as a package and a sample source file (i.e., <code>main.bal</code>) with a main function.</p>
<p>To provide the configurations required, create a new file named `Config.toml`` and add the send/receive phone numbers, SID, and auth token received from Twilio. The file structure within the package will look like below.</p>
<p><img src="./images/twilio/ballerina-package-structure.png" alt="Alt text" /></p>
<p>Add the following code to <code>main.bal</code> file.</p>
<pre><code class="language-bal">import ballerina/log;
import ballerinax/twilio;

configurable string accountSId = ?;
configurable string authToken = ?;
configurable string fromNumber = ?;
configurable string fromWhatsAppNumber = ?;
configurable string toNumber = ?;

configurable string message = &quot;This is a test message from Ballerina&quot;;

//Create Twilio client
final twilio:Client twilio = check new ({twilioAuth: {accountSId, authToken}});

public function main() returns error? {
    //Send SMS
    twilio:SmsResponse smsResponse = check twilio-&gt;sendSms(fromNumber, toNumber, message);
    log:printInfo(string `SMS Response: ${smsResponse.toString()}`);

    //Get the details of SMS sent above
    twilio:MessageResourceResponse details = check twilio-&gt;getMessage(smsResponse.sid);
    log:printInfo(&quot;Message Detail: &quot; + details.toString());

    //Make a voice call
    twilio:VoiceCallResponse voiceResponse = check twilio-&gt;makeVoiceCall(fromNumber, toNumber, {
        userInput: message,
        userInputType: twilio:MESSAGE_IN_TEXT
    });
    log:printInfo(string `Voice Call Response: ${voiceResponse.toString()}`);

    //Send whatsapp message
    twilio:WhatsAppResponse whatsappResponse = check twilio-&gt;sendWhatsAppMessage(fromWhatsAppNumber, toNumber, message);
    log:printInfo(string `WhatsApp Response: ${whatsappResponse.toString()}`);

    // Get Account Details
    twilio:Account accountDetails = check twilio-&gt;getAccountDetails();
    log:printInfo(string `Account Details: ${accountDetails.toString()}`);

}
</code></pre>
<p>Add the configuration values to the <code>Config.toml</code> file. It will look like below.</p>
<pre><code>accountSId=&quot;xxxxxxxxxxxxxxxxxxxxxxx&quot;
authToken=&quot;xxxxxxxxxxxxxxxxxxxxxxx&quot;
fromNumber=&quot;+1xxxxxxxxxx&quot;
fromWhatsAppNumber=&quot;+1xxxxxxxxxx&quot;
toNumber=&quot;+1xxxxxxxxxx&quot;
</code></pre>
<p>Then, run the program using <code>bal run    </code> command, and you will see the following logs.</p>
<pre><code>time = 2023-08-29T16:54:47.536-05:00 level = INFO module = anupama/twilio_samples message = &quot;SMS Response: {\&quot;sid\&quot;:\&quot;SM12099885cce2c78bf5f50903ca83d3ac\&quot;,\&quot;dateCreated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;dateUpdated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;dateSent\&quot;:\&quot;\&quot;,\&quot;accountSid\&quot;:\&quot;xxxxxxxxxxxxx\&quot;,\&quot;toNumber\&quot;:\&quot;+1xxxxxxxxxx\&quot;,\&quot;fromNumber\&quot;:\&quot;+1xxxxxxxxxx\&quot;,\&quot;body\&quot;:\&quot;Sent from your Twilio trial account - This is a test message from Ballerina\&quot;,\&quot;status\&quot;:\&quot;queued\&quot;,\&quot;direction\&quot;:\&quot;outbound-api\&quot;,\&quot;apiVersion\&quot;:\&quot;2010-04-01\&quot;,\&quot;price\&quot;:\&quot;\&quot;,\&quot;priceUnit\&quot;:\&quot;USD\&quot;,\&quot;uri\&quot;:\&quot;/2010-04-01/Accounts/xxxxxxxxxxxxx/Messages/SM12099885cce2c78bf5f50903ca83d3ac.json\&quot;,\&quot;numSegments\&quot;:\&quot;1\&quot;}&quot;
time = 2023-08-29T16:54:47.694-05:00 level = INFO module = anupama/twilio_samples message = &quot;Message Detail: {\&quot;body\&quot;:\&quot;Sent from your Twilio trial account - This is a test message from Ballerina\&quot;,\&quot;numSegments\&quot;:\&quot;1\&quot;,\&quot;direction\&quot;:\&quot;outbound-api\&quot;,\&quot;fromNumber\&quot;:\&quot;outbound-api\&quot;,\&quot;toNumber\&quot;:\&quot;+1xxxxxxxxxx\&quot;,\&quot;dateUpdated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;price\&quot;:\&quot;\&quot;,\&quot;errorMessage\&quot;:\&quot;\&quot;,\&quot;uri\&quot;:\&quot;/2010-04-01/Accounts/xxxxxxxxxxxxx/Messages/SM12099885cce2c78bf5f50903ca83d3ac.json\&quot;,\&quot;accountSid\&quot;:\&quot;xxxxxxxxxxxxx\&quot;,\&quot;numMedia\&quot;:\&quot;0\&quot;,\&quot;status\&quot;:\&quot;sent\&quot;,\&quot;messagingServiceSid\&quot;:\&quot;\&quot;,\&quot;sid\&quot;:\&quot;SM12099885cce2c78bf5f50903ca83d3ac\&quot;,\&quot;dateSent\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;dateCreated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;errorCode\&quot;:\&quot;\&quot;,\&quot;priceUnit\&quot;:\&quot;USD\&quot;,\&quot;apiVersion\&quot;:\&quot;2010-04-01\&quot;,\&quot;subresourceUris\&quot;:\&quot;{\&quot;media\&quot;:\&quot;/2010-04-01/Accounts/xxxxxxxxxxxxx/Messages/SM12099885cce2c78bf5f50903ca83d3ac/Media.json\&quot;,\&quot;feedback\&quot;:\&quot;/2010-04-01/Accounts/xxxxxxxxxxxxx/Messages/SM12099885cce2c78bf5f50903ca83d3ac/Feedback.json\&quot;}\&quot;}&quot;
time = 2023-08-29T16:54:47.828-05:00 level = INFO module = anupama/twilio_samples message = &quot;Voice Call Response: {\&quot;sid\&quot;:\&quot;CAaa2e5a5c7591928f7e28c79da97e615a\&quot;,\&quot;status\&quot;:\&quot;queued\&quot;,\&quot;price\&quot;:\&quot;\&quot;,\&quot;priceUnit\&quot;:\&quot;USD\&quot;}&quot;
time = 2023-08-29T16:54:47.993-05:00 level = INFO module = anupama/twilio_samples message = &quot;WhatsApp Response: {\&quot;sid\&quot;:\&quot;SM3c272753409bd4814a60c7fd06d97232\&quot;,\&quot;dateCreated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;dateUpdated\&quot;:\&quot;Tue, 29 Aug 2023 21:54:47 +0000\&quot;,\&quot;dateSent\&quot;:\&quot;\&quot;,\&quot;accountSid\&quot;:\&quot;xxxxxxxxxxxxx\&quot;,\&quot;toNumber\&quot;:\&quot;whatsapp:+1xxxxxxxxxx\&quot;,\&quot;fromNumber\&quot;:\&quot;whatsapp:+1xxxxxxxxxx\&quot;,\&quot;messageServiceSid\&quot;:\&quot;\&quot;,\&quot;body\&quot;:\&quot;This is a test message from Ballerina\&quot;,\&quot;status\&quot;:\&quot;queued\&quot;,\&quot;numSegments\&quot;:\&quot;1\&quot;,\&quot;numMedia\&quot;:\&quot;0\&quot;,\&quot;direction\&quot;:\&quot;outbound-api\&quot;,\&quot;apiVersion\&quot;:\&quot;2010-04-01\&quot;,\&quot;price\&quot;:\&quot;\&quot;,\&quot;priceUnit\&quot;:\&quot;\&quot;,\&quot;errorCode\&quot;:\&quot;\&quot;,\&quot;errorMessage\&quot;:\&quot;\&quot;,\&quot;uri\&quot;:\&quot;\&quot;,\&quot;subresourceUris\&quot;:\&quot;{\&quot;media\&quot;:\&quot;/2010-04-01/Accounts/xxxxxxxxxxxxx/Messages/SM3c272753409bd4814a60c7fd06d97232/Media.json\&quot;}\&quot;}&quot;
time = 2023-08-29T16:54:48.076-05:00 level = INFO module = anupama/twilio_samples message = &quot;Account Details: {\&quot;sid\&quot;:\&quot;xxxxxxxxxxxxx\&quot;,\&quot;name\&quot;:\&quot;My first Twilio account\&quot;,\&quot;status\&quot;:\&quot;active\&quot;,\&quot;type\&quot;:\&quot;Trial\&quot;,\&quot;createdDate\&quot;:\&quot;Fri, 18 Aug 2023 21:14:20 +0000\&quot;,\&quot;updatedDate\&quot;:\&quot;Fri, 18 Aug 2023 21:14:54 +0000\&quot;}&quot;
</code></pre>
<p>Also, you will get an SMS, a voice call, and a WhatsApp message to the specified number.</p>
<p>Are you interested in seeing this sample's sequence diagram generated by the Ballerina VS Code plugin? You can see the interactions with Twilio clearly in this diagram without reading the code. The Sequence diagram can capture how the logic of your program flows, how the concurrent execution flow works, which remote endpoints are involved, and how those endpoints interact with the different workers in the program. See the <a href="https://wso2.com/ballerina/vscode/docs/implement-the-code/sequence-diagram-view/">Sequence diagram view</a> for more details.</p>
<p><img src="./images/twilio/ballerina-with-twilio-sequence-diagram.png" alt="Alt text" /></p>
<h3 id="complete-code"><a class="header" href="#complete-code">Complete code</a></h3>
<p>Refer to the code in <a href="https://github.com/learn-ballerina/ballerina-library-samples/tree/main/twilio/send-recieve-with-twilio">send-receive-with-twilio</a></p>
<h2 id="sample-2-use-twiml-for-programmable-messaging-with-ballerina"><a class="header" href="#sample-2-use-twiml-for-programmable-messaging-with-ballerina">Sample 2: Use TwiML for Programmable Messaging With Ballerina</a></h2>
<p>The <a href="http://twilio.com/docs/messaging/twiml">TwiML</a> (Twilio Markup Language) is a set of instructions you can use to tell Twilio what to do when you receive an incoming call, SMS, MMS, or WhatsApp message.</p>
<p>Let’s see how to write a Ballerina program that makes a voice call with the instructions of the given TwiML URL. Here, we need to have <a href="https://lib.ballerina.io/ballerinax/twilio/2.0.0#VoiceCallInputType">a URL that returns TwiML Voice instructions</a> to make the call. </p>
<p>If you don’t have such a URL that returns TwiML, you can write a simple Ballerina HTTP service to return it as follows and run it. The instruction returned by this service will contain a bell sound, which is looped ten times. </p>
<pre><code class="language-bal">import ballerina/http;

service /twilio on new http:Listener(9090) {

    resource function post voice() returns xml {
        xml response = xml `&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
        &lt;Response&gt;
            &lt;Play loop=&quot;10&quot;&gt;https://api.twilio.com/cowbell.mp3&lt;/Play&gt;
        &lt;/Response&gt;`;
        return response;
    }
}
</code></pre>
<p>If you are running the above service locally, you need to expose it to external so that it can be accessed by Twilio when making the call. You can use <a href="https://ngrok.com/">ngrok</a> for that, which is a cross-platform application that enables developers to expose a local development server to the Internet with minimal effort.</p>
<p>Expose the above service with the following <code>ngrok</code> command.</p>
<pre><code>./ngrok http 9090
</code></pre>
<p>This will return a URL similar to the following: </p>
<pre><code>https://a624-2600-1700-1bd0-1390-9587-3a61-a470-879b.ngrok.io
</code></pre>
<p>Then, you can append it with the service path and resource path in your above Ballerina service to be used with the Twilio voice call example. </p>
<pre><code>https://a624-2600-1700-1bd0-1390-9587-3a61-a470-879b.ngrok.io/twilio/voice
</code></pre>
<p>Next, write your Ballerina code as follows. Use the above complete ngrok URL as the <code>voiceTwimUrl</code> configurable. </p>
<pre><code class="language-bal">import ballerina/log;
import ballerinax/twilio;

configurable string accountSId = ?;
configurable string authToken = ?;
configurable string fromNumber = ?;
configurable string toNumber = ?;
configurable string voiceTwimUrl = ?;

//Create Twilio client
final twilio:Client twilio = check new ({twilioAuth: {accountSId, authToken}});

public function main() returns error? {
    //Make a voice call
    twilio:VoiceCallResponse voiceResponse = check twilio-&gt;makeVoiceCall(fromNumber, toNumber, {
        userInput: voiceTwimUrl,
        userInputType: twilio:TWIML_URL
    });
    log:printInfo(string `Voice Call Response: ${voiceResponse.toString()}`);

}
</code></pre>
<p>When running the program, you will receive a phone call to the specified number with a Bell sound of 10 times. You can see the below logs in your Ballerina application.</p>
<pre><code>time = 2023-08-29T17:03:13.804-05:00 level = INFO module = anupama/twilio_samples message = &quot;Voice Call Response: {\&quot;sid\&quot;:\&quot;CA3d8f5cd381a4eaae1028728f00770f00\&quot;,\&quot;status\&quot;:\&quot;queued\&quot;,\&quot;price\&quot;:\&quot;\&quot;,\&quot;priceUnit\&quot;:\&quot;USD\&quot;}&quot;
</code></pre>
<h3 id="complete-code-for-instruction-server"><a class="header" href="#complete-code-for-instruction-server">Complete code for instruction server</a></h3>
<p>Refer to the code in <a href="https://github.com/learn-ballerina/ballerina-library-samples/tree/main/twilio/twiml-intruction-server">twiml-instruction-server</a></p>
<h3 id="complete-code-for-instruction-server-1"><a class="header" href="#complete-code-for-instruction-server-1">Complete code for instruction server</a></h3>
<p>Refer to the code in <a href="https://github.com/learn-ballerina/ballerina-library-samples/tree/main/twilio/twiml-voice-call">twiml-voice-call</a></p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In conclusion, Twilio’s synergy with Ballerina through the <code>ballerinax/twilio</code> package presents a powerful tool for elevating your application’s communication prowess. The showcased sample code highlights its ease and adaptability, setting it apart from connectors in other languages. </p>
<p>Hope you’ve enjoyed making calls and sending messages using this seamless integration.</p>

                    </main>
                    <script src="https://utteranc.es/client.js" repo="learn-ballerina/learn-ballerina.github.io" issue-term="pathname" theme="github-light"
                    crossorigin="anonymous" async>
                    </script>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../ballerina-library-samples/ballerina-library-samples.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../ballerina-library-samples/ballerina-library-samples.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</script>
</html>
